<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jobless RO: Rouge Edition v1.1.2</title>
    <style>
        /* --- CORE STYLE & NEON BRANDING --- */
        :root { --bg:#050505; --p:#0a0a0a; --bd:#39ff14; --n:#39ff14; --t:#ffffff; --d:#aaaaaa; --hp:#ff4444; --sp:#4488ff; --r:#ffff00; --font:'Tahoma', sans-serif; }
        * { box-sizing:border-box; user-select:none; -webkit-tap-highlight-color:transparent; }
        input { user-select: text !important; background:#000; color:var(--n); border:1px solid var(--bd); padding:5px; width: 100%; text-align: center; }
        body { background: var(--bg); color: var(--t); font-family: var(--font); font-size: 11px; margin: 0; padding: 0; width: 100vw; height: 100dvh; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        #app { width: 100%; max-width: 500px; height: 100%; display: flex; flex-direction: column; gap: 6px; padding: 10px; border: 1px solid var(--bd); background: var(--bg); position: relative; }
        
        /* --- TRANSLATION STABILITY --- */
        .lang-en .cn, .lang-cn .en { display: none !important; }

        /* --- BUTTONS & PANELS --- */
        button { background: #000; color: var(--n); border: 1px solid var(--bd); padding: 10px; font: inherit; font-weight: bold; cursor: pointer; text-transform: uppercase; display: flex; align-items: center; justify-content: center; min-height: 38px; }
        button:active, button.active { background: var(--n); color:#000; box-shadow: 0 0 10px var(--n); }
        .btn-sm { padding:4px 8px; font-size:10px; min-height: 22px; }
        .btn-red { border-color:var(--hp); color:var(--hp); }
        .btn-neon { border: 2px solid var(--bd) !important; box-shadow: 0 0 15px rgba(57, 255, 20, 0.4); }
        .panel { border:1px solid var(--bd); background:var(--p); padding:6px; }
        .flex { display:flex; justify-content:space-between; align-items:center; }
        .grid { display:grid; gap:4px; } .g-2 { grid-template-columns:1fr 1fr; } .g-6 { grid-template-columns:repeat(6,1fr); }
        .stat-cell { text-align:center; font-size:9px; color:#666; border-right:1px solid #222; padding: 2px 0; }
        .stv { color: #fff; font-weight: bold; display: block; font-size: 11px; }

        /* --- SPRITE ENGINE --- */
        #stage { height: 120px; background: #111; border-bottom: 1px dashed var(--bd); display: flex; justify-content: space-between; align-items: flex-end; padding: 20px 40px; position: relative; }
        .avatar-box { width: 40px; height: 60px; position: relative; display: flex; justify-content: center; align-items: flex-end; }
        .spr { width:30px; height:40px; position:absolute; bottom:0; animation: idle 1.2s infinite steps(2); }
        .hd { width:20px; height:18px; background:#fca; position:absolute; left:5px; top:0; z-index:5; border-radius:4px; }
        .bd { width:18px; height:16px; background:#eee; position:absolute; left:6px; top:16px; z-index:3; border-radius:2px; }
        .hr { background:#853; position:absolute; }
        .ro-m .hr { width:24px; height:10px; left:3px; top:-2px; z-index:6; border-radius:4px 4px 0 0; } 
        .ro-f .hr { width: 28px; height: 26px; left: 1px; top: -3px; z-index: 2; border-radius: 12px; }

        /* --- MONSTER ART (OFFLOADED) --- */
        [data-mob="Poring"] .hd { background: #fca; border-radius: 50%; width: 24px; height: 20px; top: 15px; }
        [data-mob="Angeling"] .hd { background: #fff; border-radius: 50%; width: 32px; height: 28px; top: 5px; box-shadow: 0 0 10px #fff; }
        [data-mob="Baphomet"] .hd { background: #333; border-radius: 5px; width: 42px; height: 52px; top: -18px; }
        [data-mvp="true"] { transform: scale(1.3); }
        [data-mvp="true"] .spr { filter: drop-shadow(0 0 10px var(--r)); }

        /* --- ANIMATIONS --- */
        @keyframes idle { 0%,100%{transform:translateY(0)} 50%{transform:translateY(2px)} }
        @keyframes shake { 0%,100%{transform:translate(0)} 25%{transform:translate(-3px,1px)} 75%{transform:translate(3px,-1px)} }
        .anim-shake { animation: shake 0.4s; }
        .dmg-pop { position: absolute; font-weight: bold; font-size: 16px; text-shadow: 2px 2px 0 #000; animation: floatUp 0.8s forwards; pointer-events: none; z-index: 99; color: #fff; }
        @keyframes floatUp { 0%{opacity:1;transform:translateY(0)} 100%{opacity:0;transform:translateY(-40px)} }
        progress { width:100%; height:8px; appearance:none; border:none; background:#222; margin-top:2px; }
        #bh::-webkit-progress-value, #ae::-webkit-progress-value { background:var(--hp); }
        #ap::-webkit-progress-value { background:var(--n); }
        .hide { display:none !important; }
    </style>
</head>
<body class="lang-en">
<div id="app">
    <header class="panel grid">
        <div class="flex" style="border-bottom:1px dashed var(--bd); padding-bottom:5px;">
            <div class="flex" style="gap:4px">
                <button class="btn-sm btn-red" onclick="G.wipe()"><span class="en">RESET</span><span class="cn">重置</span></button>
                <button class="btn-sm" onclick="G.exp()"><span class="en">SAVE</span><span class="cn">存檔</span></button>
                <button class="btn-sm" onclick="el('fi').click()"><span class="en">LOAD</span><span class="cn">讀檔</span></button>
                <input type="file" id="fi" style="display:none" onchange="G.imp(this)">
                <button class="btn-sm" onclick="G.lang()">EN/中</button>
                <button id="b-au" class="btn-sm" onclick="G.tAu()"><span class="en">AUTO</span><span class="cn">自動</span></button>
            </div>
            <div class="flex" style="gap:2px">
                <button class="btn-sm" onclick="G.spd(10)">1x</button>
                <button class="btn-sm" onclick="G.spd(100)">MAX</button>
            </div>
        </div>
        <div class="flex">
            <div style="flex:1;">
                <div class="flex">
                    <div><b id="un" class="c-n"></b> <span id="uj"></span></div>
                    <div>Lv <span id="ul"></span> <span class="c-d">F<span id="ufl"></span></span></div>
                </div>
                <div class="grid g-2">
                    <div style="font-size:9px">HP <span id="uh"></span><progress id="bh"></progress></div>
                    <div style="font-size:9px">SP <span id="us"></span><progress id="bs"></progress></div>
                </div>
            </div>
        </div>
        <div class="grid g-6" id="stat-row"></div>
    </header>
    <section id="btl" class="panel">
        <div id="stage">
            <div id="p-box" class="avatar-box"><div id="spr" class="spr ro-m"><div class="hr"></div><div class="hd"></div><div class="bd"></div></div></div>
            <div id="e-box" class="avatar-box" data-mob="Poring"><div class="spr"><div class="hd"></div><div class="bd"></div></div></div>
        </div>
        <div class="grid"><progress id="ap" max="1000"></progress><progress id="ae" max="1000"></progress></div>
    </section>
    <nav id="ctl" class="grid g-2" style="min-height:100px"></nav>
</div>

<script>
const J=[{hp:60,sp:20,as:50},{hp:150,sp:40,as:45},{hp:80,sp:120,as:60},{hp:110,sp:50,as:35},{hp:100,sp:60,as:40},{hp:90,sp:100,as:55},{hp:120,sp:50,as:50},{hp:350,sp:80,as:40},{hp:150,sp:280,as:55},{hp:240,sp:100,as:25},{hp:220,sp:120,as:35},{hp:200,sp:220,as:50},{hp:280,sp:100,as:45}];
const B=[{n:'Angeling',h:2500,a:80,mvp:true},{n:'Baphomet',h:99999,a:1800,mvp:true}];
const SK0=[{n:'FirstAid',en:'First Aid',cn:'緊急治療',v:20,t:'h'},{n:'Bash',en:'Bash',cn:'狂擊',v:1.4,t:'p'},{n:'Napalm',en:'Napalm Beat',cn:'心靈爆破',v:1.5,t:'m'}];
const ARCH = { Melee:[1,6,7,12], Magical:[2,5,8,11], Rouge:[3,4,9,10] };
const K='jro_rouge_v1', el=i=>document.getElementById(i), rnd=m=>Math.floor(Math.random()*m);



const G={
    p:null, s:{f:1,b:false,tm:null,spd:10,au:false,l:'en'}, tmp:{g:'m'}, pb:0, eb:0, mob:null,
    init(){ const r=localStorage.getItem(K); try { if(r){ this.p=JSON.parse(atob(r)); document.body.className='lang-'+this.s.l; this.draw(); this.mnu(); } else { this.scr(); } } catch(e){ this.scr(); } },
    scr(){ el('ctl').innerHTML=`<div class="panel" style="grid-column:span 2;text-align:center"><input id="in" placeholder="NAME"><div class="flex" style="justify-content:center;gap:10px;margin:10px 0"><button onclick="G.setG('m')">M</button><button onclick="G.setG('f')">F</button></div><button onclick="G.ng()" style="width:100%"><span class="en">START</span><span class="cn">開始</span></button></div>`; },
    setG(g){ this.tmp.g=g; el('spr').className=`spr ro-${g} j-0`; },
    ng(){ this.p={n:el('in').value||"Novice",j:0,lv:1,xp:0,hp:60,mh:60,sp:20,str:1,agi:1,vit:1,int:1,dex:1,luk:1,pts:5,sk:{},act:null,g:this.tmp.g,arch:null}; this.skM(); },
    skM(){ el('ctl').innerHTML=''; SK0.forEach(s=>{ this.btn(`<span class="en">${s.en}</span><span class="cn">${s.cn}</span>`, ()=>{ this.p.sk[s.n]=1; this.p.act=s; this.stM(true); }); }); },
    stM(st){ el('ctl').innerHTML=''; ['str','agi','vit','int','dex','luk'].forEach(k=>{ this.btn(k.toUpperCase()+"+",()=>{if(this.p.pts>0){this.p[k]++;this.p.pts--;this.draw();this.stM(st);}}); }); if(st||this.p.pts==0) this.btn(`<span class="en">OK</span><span class="cn">確定</span>`,()=>{ if(this.p.lv>=10&&!this.p.arch)this.jbM(); else this.mnu(); }); },
    jbM(){ el('ctl').innerHTML=''; ["Melee","Magical","Rouge"].forEach(type => { this.btn(`<span class="en">${type}</span>`, () => { this.p.arch = type; el('ctl').innerHTML=''; ARCH[type].filter(id=>id<7).forEach(jID => { this.btn(`JOB ${jID}`, () => { this.p.j = jID; this.p.mh+=100; this.p.hp=this.p.mh; this.mnu(); }); }); }, 'btn-neon'); }); },
    calc(c){ const j=J[c.j]; let atk=c.str+(c.dex/5)+c.lv*2, flee=c.agi+c.lv; return {atk:Math.floor(atk), aspd:Math.floor(j.as+(c.agi*0.8)), hit:c.dex+c.lv, flee, def:Math.floor(c.vit/2)}; },
    mnu(){ this.sv(); el('ctl').innerHTML=''; this.draw(); if(this.s.au && !this.s.b){ setTimeout(()=>this.bt(this.s.f%10==0), 600); return; } this.btn(`<span class="en">${this.s.f%10==0?'BOSS':'FIGHT'}</span><span class="cn">${this.s.f%10==0?'首領':'戰鬥'}</span>`, ()=>this.bt(this.s.f%10==0), this.s.f%10==0?'btn-red':''); this.btn(`<span class="en">REST</span><span class="cn">休息</span>`, ()=>{this.p.hp=this.p.mh; this.draw();}); },
    bt(isB){ if(this.s.b) return; this.s.b=true; this.mob = isB ? {...B[rnd(B.length)]} : {n:'Poring',h:this.s.f*40,a:this.s.f*5}; this.mob.hp=this.mob.h; el('e-box').setAttribute('data-mob', this.mob.n); el('e-box').setAttribute('data-mvp', isB); this.s.tm = setInterval(()=>this.loop(), 30); },
    loop(){ for(let i=0; i<this.s.spd; i++){ if(!this.s.b) break; this.tk(); } this.uiTick(); },
    tk(){ const ps = this.calc(this.p); this.pb += ps.aspd; this.eb += 10; if(this.pb>=1000){ this.pb=0; this.act(this.p,this.mob,ps,true); } if(this.eb>=1000){ this.eb=0; this.act(this.mob,this.p,{hit:80+(this.s.f*1.5),atk:this.mob.a},false); } },
    act(s, t, st, p){ const targetBox = p ? el('e-box') : el('p-box'); const tflee = p ? 0 : this.calc(this.p).flee; if (Math.random() * 100 > Math.max(5, 80 + (st.hit - tflee))) { this.pop(targetBox,"MISS"); return; } let d = Math.max(1, (st.atk * (this.p.act?.v||1)) - (p ? 0 : st.def)); t.hp -= Math.floor(d); if(this.s.spd <= 30) { this.pop(targetBox, Math.floor(d)); targetBox.classList.add('anim-shake'); setTimeout(()=>targetBox.classList.remove('anim-shake'), 400); } if (t.hp <= 0) this.win(p); },
    win(p){ clearInterval(this.s.tm); this.s.b=false; if(!p) { el('ctl').innerHTML=`<button onclick="location.reload()"><span class="en">REBORN</span><span class="cn">復活</span></button>`; return; } this.p.xp += 150; this.s.f++; this.mnu(); },
    uiTick(){ el('uh').innerText=Math.floor(this.p.hp); el('bh').value=this.p.hp; el('bh').max=this.p.mh; el('ae').value=this.mob.hp; el('ae').max=this.mob.mh; el('ap').value=this.pb; },
    draw(){ el('un').innerText=this.p.n; el('ul').innerText=this.p.lv; el('ufl').innerText=this.s.f; el('spr').className = `spr ro-${this.p.g} j-${this.p.j}`; el('stat-row').innerHTML = ['str','agi','vit','int','dex','luk'].map(k=>`<div class="stat-cell">${k.toUpperCase()}<br><b class="stv">${this.p[k]}</b></div>`).join(''); },
    pop(dom, txt){ const d=document.createElement('div'); d.className=`dmg-pop`; d.innerText=txt; dom.appendChild(d); setTimeout(()=>d.remove(), 800); },
    btn(t, fn, c=''){ const b=document.createElement('button'); b.innerHTML=t; b.onclick=fn; if(c) b.className=c; el('ctl').appendChild(b); },
    lang(){ this.s.l=this.s.l=='en'?'cn':'en'; document.body.className='lang-'+this.s.l; this.draw(); this.mnu(); },
    spd(x){ this.s.spd=x; },
    tAu(){ this.s.au=!this.s.au; if(!this.s.b) this.mnu(); },
    sv(){ localStorage.setItem(K, btoa(JSON.stringify(this.p))); },
    wipe(){ localStorage.removeItem(K); location.reload(); },
    exp(){ const a=document.createElement('a'); a.href='data:text/plain;base64,'+btoa(JSON.stringify(this.p)); a.download='save.jro'; a.click(); },
    imp(e){ const f=e.files[0], r=new FileReader(); r.onload=x=>{this.p=JSON.parse(atob(x.target.result));this.draw();this.mnu();}; r.readAsText(f); }
};
G.init();
</script>
</body>
</html>